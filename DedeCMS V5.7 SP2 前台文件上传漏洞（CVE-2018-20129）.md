# DedeCMS V5.7 SP2 前台文件上传漏洞（CVE-2018-20129）

本文仅用于技术讨论与研究，文中的实现方法切勿应用在任何违法场景。如因涉嫌违法造成的一切不良影响，本文作者概不负责。

## 漏洞描述

织梦内容管理系统(Dedecms)是一款PHP开源网站管理系统。Dedecms V5.7 SP2版本中正常用户登录后，前台发表文章可上传绕过 `getshell`

## 漏洞影响

DedeCMS V5.7 SP2

## 漏洞复现

首先需要有一个用户，注册一个即可，然后需要管理员审核通过，不然不能发表文章，变成正常用户后可以发表文章

```plain
内容用户 -> 发表文章
```

详细内容中的富文本编辑器上传图片，`burp` 抓包后修改如图

![img](https://gitee.com/N0puple/nopic/raw/master/img/20210702211118.png)

![img](https://cdn.nlark.com/yuque/0/2022/png/22586461/1650464334265-140d8963-018f-40bb-ac27-8eb51f0be525.png)

## 总结

这里成功利用的前提是要有一个可以发表文章的用户，看起来分析很短，但是不得不说，这个漏洞非常的巧妙，多个巧合才有了这个漏洞。

## 参考

- `https://wiki.bylibrary.cn/漏洞库/01-CMS漏洞/DedeCMS/Dedecms前台文件上传漏洞CVE-2018-20129/`



`github` 链接：`https://github.com/N0puple/vulPOC`

想要获取更多资讯，或者获取文中环境可以关注公众号 “安全漏洞复现”，回复 “漏洞环境”
