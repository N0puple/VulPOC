## CVE-2021-36394 Pre-Auth RCE in Moodle

### 漏洞简介

`Moodle` 是世界上最流行的学习管理系统。在几分钟内开始创建您的在线学习网站！

`Moodle`的`Shibboleth`认证模块存在一个未授权远程代码执行漏洞。这在大学中被广泛使用，以允许来自一所大学的学生与其他大学进行身份验证，从而使他们能够参加外部课程并与其他人一起玩乐。

### 漏洞分析

https://xz.aliyun.com/t/10383

### 环境搭建

```
git clone https://github.com/N0puple/poc-set
cd "poc-set/CVE-2021-36394 Pre-Auth RCE in Moodle"
docker-compose up -d
```

然后进入 `docker` ，更改文件 `/var/www/html/moodle-3.11.0/config.php`

```
$CFG->wwwroot   = 'http://127.0.0.1';
```

将上面的链接改为自己的，必须是真实地址

### 漏洞利用

```
python3 moodle_rce.py http://example.com
```

![img](https://cdn.nlark.com/yuque/0/2021/png/22586461/1634477001713-fe9ed115-8d5c-4d85-af78-4c8a514dd861.png)

